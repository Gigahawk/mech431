#+TITLE: MECH 431 Midterm 1 Submission
#+AUTHOR: Jasper Chan - 37467164
#+OPTIONS: toc:nil
#+LATEX_HEADER: \usepackage{mathtools}
#+LATEX_HEADER: \usepackage{xcolor}
#+LATEX_HEADER: \usepackage{textcomp}
#+BEGIN_SRC ipython :session :exports none
%config InlineBackend.figure_format = 'svg'
from matplotlib import pyplot as plt
import matplotlib
import numpy as np

#+END_SRC

#+RESULTS:
: # Out[68]:

1. *[2 marks]* Engineering Economics considers the economic aspects of
   decision making. What criteria other than economics factor into
   engineering decision making for large, complex projects (name two)?

   - Social (i.e. is it socially acceptable to build a project on land owned by First Nations)
   - Technical (i.e. is the project even feasible)

2. *[1 mark]* What does marginal revenue represent? What are sunk costs?

   - Marginal revenue is the extra revenue generated by selling one more unit of something.
     - Excludes fixed revenues (i.e. a fixed installation fee for a variable amount/size of product)
   - Sunk costs are costs that happened in the past and can no longer be recovered

3. *[2 marks]* Create a cash flow diagram for the following loan. You
   borrow $10,000, at 10% interest, compounded annually, for seven
   years. You make interest only payments for term of the loan and pay
   off the principal in full at the end of the loan term.
   #+BEGIN_SRC ipython :session :results raw drawer :exports results
width = 0.35

principal = 100000
interest = 0.1
time_principal = []
time_interest = []

# Borrow / gain the the initial principal at time 0
time_principal.append(principal)
time_interest.append(0)

for t in range(7):
    if t != 6:
        time_principal.append(0)
    else:
        time_principal.append(-principal)
    time_interest.append(-principal*interest)

time = range(len(time_principal))

plt.bar(time, time_principal, width, label="Principal")
plt.bar(time,time_interest, width, label="Interest", bottom=time_principal)

plt.axhline(linewidth=1, color='k')

plt.xlabel("Time (years)")
plt.ylabel("Money ($)")
plt.legend(bbox_to_anchor=(1.5, 1))

None
   #+END_SRC

   #+RESULTS:
   :RESULTS:
   # Out[72]:
   [[file:./obipy-resources/Ls9wEM.svg]]
   :END:

   \pagebreak
4. [2 marks] You are planning on purchasing a house and will take out a
   mortgage for $325,000 to do so. The bank charges 4.2% interest
   compounded semi-annually, and you will be making monthly payments. If
   you pay back the loan over 25 years, what will be your monthly
   payment amount?
    #+BEGIN_SRC ipython :session :results raw drawer :exports results
    P = 325000
    i = 0.042 # Annual
    c = 2 # 2 semi-annual compounding periods per year
    p = 12 # 12 monthly payments per year
    y = 25 # Payment over 25 years
    n = y * p # Total number of payments

    i_eq = (1+i/c)**(c/p) - 1

    A = P/(((1 + i_eq)**n - 1)/(i_eq*(1 + i_eq)**n))

    f'${round(A)}'
    #+END_SRC
    #+RESULTS:
    :RESULTS:
    # Out[88]:
    : '$1745'
    :END:

5. *[2 marks]* You wish to donate to an endowment fund missionary or other
   charitable works through your preferred religious institution. You
   want the funding to provide $12,500 every year. Being somewhat
   quirky, you also want the fund to pay out a $25,000 grant (in
   addition to the $12,500) every 10 years in celebration of your
   preferred religious celebration. If the endowment fund earns an
   annual return of 4.5%, how much do you need to donate to provide for
   this set of funding forever? (Assume the first additional grant will
   be in the tenth year after the funding is established).

   Let's start out with some initial principal $P_0$.
   Every year the interest will pay out $i \cdot P$.
   Every year we need the interest to be the yearly annuity $A_y$
   plus some amount to go towards the decennially grant $A_D$.
   By the first year the amount in the bank will be
   $$P_1 = P_0(1 + i) - A_y, P_1 > P_0$$
   By the second year, we will have
   $$P_2 = P_1(1 + i) - A_y, P_2 > P_1$$
   If we extrapolate this to $n$ years, we get
   $$P_n = P_{n-1}(1 + i) - A_y, P_n > P_{n-1}$$
   At year 10 we pay out the decennial grant, hence
   $$P_0 = P_{10} - A_D$$
   If we expand this out, we get
   \begin{align*}
   P_0 &= P_{10} - A_D \\
   &= (P_9(1 + i) - A_y) - A_D = P_9(1 + i) - A_y - A_D \\
   &= (P_8(1 + i) - A_y)(1 + i) - A_y - A_D = P_8(1 + i)^2 - A_y(1 + i) - A_y - A_D \\
   &= (P_7(1 + i) - A_y)(1 + i)^2 - A_y(1 + i) - A_y - A_D = P_7(1 + i)^3 - \hdots - A_D\\
   &\vdotswithin{=} \\
   &= P_0(1 + i)^{10} - A_y \sum_{n = 0}^{9}(1 + i)^n - A_D
   \end{align*}

   Solving for $P_0$ we get:
   #+BEGIN_SRC ipython :session :exports results :results raw drawer
   i = 0.045 # Annual interest
   A_y = 12500 # Annual pay out
   A_D = 25000 # Deccenial grant
   y = 10

   P_0 = (-A_y*sum([(1 + i)**n for n in range(y)]) - A_D)/(1 - (1 + i)**y)
   f'P_0 = ${round(P_0)}'
   
   #+END_SRC

   #+RESULTS:
   :RESULTS:
   # Out[180]:
   : '$322988'
   :END:

6. *[2 marks]* Some of your production equipment is very old and needs to
   be replaced. You are evaluating the replacement of a particular
   motor. This motor is a very old, custom design that is only made by
   one shop. They have indicated if you want to replace it now, they
   will make it one last time for you now, but never again after that.
   The expected lifetime of the motor is five years. Another option is
   to redesign the equipment to accept a standard motor. This will cost
   more, but have a longer lifetime as well, 10 years. Is Equivalent
   Annual Cashflow Analysis a good tool for assessing these
   alternatives? Why or why not?

   No, EACF analysis assumes that each option may be repeated at the end of it's lifetime.
   This is not the case in this situation since the old motor can no longer be sourced after it's 5 year lifetime

7. *[2 marks]* Two potential projects have the following cashflows. If you
   have a payback period of two years, which project should you choose?
   Why might this be a poor decision?

    | /*Year*/ | /*Project A*/         | /*Project B*/         |
    |----------+-----------------------+-----------------------|
    | /*0*/    | /\color{red}($2,000)/ | /\color{red}($2,000)/ |
    | /*1*/    | /$1,000/              | /$900/                |
    | /*2*/    | /$1,000/              | /$900/                |
    | /*3*/    | /$1,000/              | /$900/                |
    | /*4*/    | /$0/                  | /$900/                |
    | /*5*/    | /$0/                  | /$900/                |

    Let's calculate NPV's for each project assuming an interest of 10%
    #+BEGIN_SRC ipython :session :exports results :results output
    for i in range(1,200):
        i /= 100
        npv_A = 1000*((1 - (1/(1 + i)**3))/i)
        npv_B = 900*((1 - (1/(1 + i)**5))/i)

    i = 0.1
    npv_A = 1000*((1 - (1/(1 + i)**3))/i)
    npv_B = 900*((1 - (1/(1 + i)**5))/i)

    out = f"""
i = {i*100}%
npv_A = ${round(npv_A)}
npv_B = ${round(npv_B)}"""

    print(out)
    
    #+END_SRC

    #+RESULTS:
    : 
    : i = 10.0%
    : npv_A = $2487
    : npv_B = $3412

    For any reasonable interest rate (i.e. below $\textasciitilde 130\%$), the NPV for Project B is greater.
    However, because the payback period on the initial loan is so short, it is not possible to pay it back with Project B, so if the difference can't come from somewhere else (profits from another project) then Project A may be the only viable option.

8. *[1 mark]* Economies of scale suggests that generally, as you produce
   more of something, the average cost of production will go down.
   However, in some cases producing more output results in increased
   average costs. Give an example of why this might happen for a factory
   producing widgets.

   As you need to purchase more raw materials to manufacture your widget, the price of those materials may rise.

9. *[2 marks]* You determine the NPV of a project, and it is positive,
   indicating the project is economically worthwhile. If you were to
   determine the Equivalent Annual Uniform Cashflow (EAUC) for that
   project for one year, would the EAUC be larger, smaller, or the same
   as the NPV? Why? (assume interest rate i is greater than zero).

   The EUAC is the equivalent annuity payment that would give you the same NPV over the lifetime of the project.
   For a long term project, the EUAC is generally smaller, since the equivalent NPV would be the sum of multiple (discounted) anniuties.
   For a one year project, the EUAC will be larger, since the NPV represents the present value, whereas the EUAC will represent the value at the end of the year.

10. *[6 marks]* For the following Profit and Loss chart:

    [[file:media/image1.png]]

    What is the breakeven point in terms of units produced? What is the
    breakeven point in terms of revenue? *[1 mark]*

    The breakeven point appears to be at 200 units produced.
    #+BEGIN_SRC ipython :session :results output :exports both
    m_cost = (24875 - 24250)/(250 - 125)
    m_rev = 30000 / 250

    b_cost = 24250 - m_cost*125
    b_rev = 0

    breakeven_units = round((b_cost - b_rev)/(m_rev - m_cost))
    breakeven_rev = breakeven_units * m_rev

    out = f"""
    Breakeven point in terms of units: {breakeven_units} units
    Breakeven point in terms of revenue: ${breakeven_rev}"""

    print(out)
    #+END_SRC

    #+RESULTS:
    : 
    : Breakeven point in terms of units: 205 units
    : Breakeven point in terms of revenue: $24600.0

    What are the fixed costs for the facility? *[1 mark]*

    The $18,000 to start production (0 units)

    What are the variable costs for producing the product? *[2 marks]*

    All of the costs above the initial $18,000 startup cost.
    Depending on the number of units produced, this could range from $0 - $6875

    What is the marginal revenue for this product? *[1 mark]*

    #+BEGIN_SRC ipython :session :exports both :results raw drawer
    f"${m_rev}"
    #+END_SRC

    #+RESULTS:
    :RESULTS:
    # Out[370]:
    : '$120.0'
    :END:

    What is the average cost of production for the full 250 units? What is
    the average cost of production at 50 units? *[1 marks]*
    #+BEGIN_SRC ipython :session :exports both :results output
    cost_250 = 24875
    cost_50 = 18000 + (24250 - 18000)*(50/125)

    out = f"""
    Average cost at 250 units: ${cost_250/250}/unit
    Average cost at 50 units: ${cost_50/50}/unit
    """
    print(out)
    #+END_SRC

    #+RESULTS:
    : 
    : Average cost at 250 units: $99.5/unit
    : Average cost at 50 units: $410.0/unit
    : 

    \pagebreak
11. *[5 marks]* For the cashflow diagram below:

    [[file:media/image2.png]]

    *[a]* Calculate the Net Present Value of the cashflows given, using a
    discount rate of 25% *[3 marks]*
    #+BEGIN_SRC ipython :session :exports both :results raw drawer
    i = 0.25
    cashflow = 1000*np.array([-220, 0, 0, 0, 80, 130, 180, 230, 280, 330])

    npv = sum([rev/(1 + i)**year for year, rev in enumerate(cashflow)])

    f'${round(npv)}'
    #+END_SRC

    #+RESULTS:
    :RESULTS:
    # Out[477]:
    : '$42055.0'
    :END:

    *[b]* Write an equation to calculate the Net Present Value of the
    cashflows using Functional Notation (e.g: NPV = F*(P/F, i, n)) *[2 marks]*

    \begin{gather*}
    \text{NPV} = \sum_{n=0}^N \mathbf{F_n}(P/F, 25\%, n) \\
    \mathbf{F} = (-220000, 0, 0, 0, 80000, 130000, 180000, 230000, 280000, 330000)
    \end{gather*}

12. *[5 marks]* Prior to the launch of Uber, taxi licenses in Metro
    Vancouver could sell for upwards of $200,000. License owners would
    often not drive the cars themselves, but lease the license to other
    drivers.

    *[a]* If you purchased a license for $200,000, and leased it for $5000
    per month, what is your payback period? *[1 mark]*

    #+BEGIN_SRC ipython :session :exports both :results raw drawer
    initial_cost = 200000
    monthly_rev = 5000

    f"Payback period: {initial_cost/monthly_rev} months"
    #+END_SRC

    #+RESULTS:
    :RESULTS:
    # Out[465]:
    : 'Payback period: 40.0 months'
    :END:

    *[b]* Assume you purchased it prior to Uber for $200,000 and leased it
    for $5000 per month. After two years, Uber launched and your lease
    fees dropped to only $2000 per month. You decide this is no longer
    worthwhile, and at the end of five years (from when you first
    purchased the license), you sell it for $30,000. Assuming your
    discount rate was 15%, what was the NPV of your taxi license
    adventure? *[4 marks]*

    Taking the initial purchase to be the reference for present[fn:1]
    #+BEGIN_SRC ipython :session :exports both :results raw drawer
    r = 0.15

    periods = []
    periods.append(-200000)
    periods.extend([5000 for _ in range(2*12)])
    periods.extend([2000 for _ in range(3*12)])
    periods[-1] += 30000

    npv = sum([p/(1 + r)**y for y, p in enumerate(periods)])

    f'${round(npv)}'
    #+END_SRC

    #+RESULTS: :RESULTS: # Out[478]:
    : '$-167362'
    :END:

13. *[5 marks]* You work at an ultra-hipster micro-brewery, and are
    planning production for your new creation, a Stout IPA style
    Pilsner, “Metal Tortoise.” You use municipal water as your
    feedstock, treating it by filtration, dechlorinating, and giving it
    warm hugs at night.

    Under the agreement with the city, your water is metered, and you pay
    a flat fee of $800 per month for up to 5,000 liters of water, and
    $0.08 per liter for any water over the 5,000-liter limit. Production
    of the existing products uses 4,000 liters per month. Assume that
    production remains constant.

    *[a]* You expect to sell 800 liters per month of Metal Tortoise.
    Regarding water only, what is the marginal cost of the additional
    water you need to add this product? *[1 mark]*

    Since we're under the 5000 litre limit, there is no extra incurred cost for using the water and the marginal cost is $0

    *[b]* What is the average cost per liter of water for just the old,
    pre-Metal Tortoise product lines? What is the average cost per litre
    of water when you also sell 800 litres per month of Metal Tortoise?
    What is the average cost per litre of water if you instead produce
    1,200 liters per month of Metal Tortoise? *[2 marks]*

    #+BEGIN_SRC ipython :session :exports both :results output
    fixed_cost = 800
    avg_pre = fixed_cost/4000
    avg_post = fixed_cost/4800

    marginal_cost = 0.08
    extra_cost = marginal_cost*200
    avg_more = (fixed_cost + extra_cost)/5200

    out = f"""
    Average cost pre-Metal Tortoise: ${round(avg_pre, 2)}
    Average cost post-Metal Tortoise: ${round(avg_post, 2)}
    Average cost post-Metal Tortoise (1200L/month): ${round(avg_more, 2)}
    """

    print(out)
    #+END_SRC

    #+RESULTS:
    : 
    : Average cost pre-Metal Tortoise: $0.2
    : Average cost post-Metal Tortoise: $0.17
    : Average cost post-Metal Tortoise (1200L/month): $0.16
    : 
    [fn:2]

    *[c]* What is the total cost for water for just the old, pre-existing
    products? What is the total monthly cost for water with Metal
    Tortoise, if you're selling 1200 litres of it per month? *[1 mark]*

    #+BEGIN_SRC ipython :session :exports both :results output
    out = f"""
    Total cost for preexisting products: ${fixed_cost}
    Total cost with Metal Tortoise: ${fixed_cost + extra_cost}
    """
    print(out)
    #+END_SRC

    #+RESULTS:
    : 
    : Total cost for preexisting products: $800
    : Total cost with Metal Tortoise: $816.0
    : 

    *[d]* Is water at your facility a fixed or variable cost? Explain. *[1 mark]*

    Below 5000 litres, it is a fixed cost since the cost does not change with output.
    Above 5000 litres, there is a marginal cost for every additional litre, making it a variable cost.

14. *[6 marks]* You are trying to decide between manufacturing a part
    using a standard milling machine or a CNC machine. The Standard Mill
    option will cost $5,000 in capital, have an annual operating cost of
    $2,000, and annual benefits of $4,000. The CNC Mill will cost
    $16,000 in capital, but have an annual operating cost of only $750
    and an annual benefit of $4,000. Your interest rate is 12% per year.
    The Standard Mill has a useful life of 5 years, the CNC Mill has a
    useful life of 10 years. The standard mill will have a salvage value
    of $2000 at the end of its life.

    *[a]* Which alternative should you select based on a Present Value
    analysis? *[6 marks]*

    Applying LCM to the mill to extend the analysis period to 10 years:
    #+BEGIN_SRC ipython :session :exports both :results output
    i = 0.12

    periods_mill = []
    periods_mill.append(-5000) # Initial purchase
    periods_mill.extend([4000 - 2000 for _ in range(5)]) # costs - benefits
    periods_mill[-1] += 2000 # Salvage value of end of life mill
    periods_mill[-1] -= 5000 # Buying a new one to replace end of life mill
    periods_mill.extend([4000 - 2000 for _ in range(5)]) # costs - benefits
    periods_mill[-1] += 2000 # Salvage value of end of life mill

    npv_mill = sum([f/(1 + i)**n for n, f in enumerate(periods_mill)])

    periods_cnc = []
    periods_cnc.append(-16000)
    periods_cnc.extend([4000 - 750 for _ in range(10)])

    npv_cnc = sum([f/(1 + i)**n for n, f in enumerate(periods_cnc)])

    out = f"""
    NPV of mill (2 lifetimes): ${round(npv_mill)}
    NPV of CNC machine: ${round(npv_cnc)}
    """
    print(out)
    #+END_SRC

    #+RESULTS:
    : 
    : NPV of mill (2 lifetimes): $5242
    : NPV of CNC machine: $2363
    : 

* Footnotes

[fn:2] Test instruction 6 specifies that monetary amounts must be accurate to the nearest dollar, in which case all of these answers would be $0

[fn:1] If the present is taken to be after the selling, then the NPV is zero since everything is a sunk cost
